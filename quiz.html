<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz</title>
    <style>
        /* ƒê·∫∑t ph√¥ng ch·ªØ m·∫∑c ƒë·ªãnh cho to√†n b·ªô trang */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }

        /* C·∫•u h√¨nh cho body */
        body {
            background-color: #f4f7fc;
            color: #333;
            font-size: 16px;
            line-height: 1.6;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            padding: 20px;
            position: relative;
        }

        /* Container ch·ª©a quiz */
        .quiz-container {
            background-color: #ffffff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
            width: 100%;
            max-width: 600px;
            text-align: left;
        }

        /* Header ch·ª©a c√°c n√∫t Home v√† Finish */
        .header {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            display: flex;
            justify-content: space-between;
            width: calc(100% - 40px);
            z-index: 10;
        }

        .header button {
            padding: 10px 20px;
            font-size: 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        /* M√†u s·∫Øc c√°c n√∫t */
        #home {
            background-color: #4CAF50;
            color: white;
        }

        #finish {
            background-color: #ff5722;
            color: white;
        }

        #home:hover {
            background-color: #45a049;
        }

        #finish:hover {
            background-color: #e64a19;
        }

        /* N√∫t Finish ·∫©n khi ch∆∞a ƒë·∫øn c√¢u cu·ªëi */
        #finish {
            display: none;
        }

        /* C√¢u h·ªèi */
        #question {
            font-size: 20px;
            margin-top: 60px; /* Th√™m kho·∫£ng c√°ch ƒë·ªÉ c√¢u h·ªèi kh√¥ng b·ªã che b·ªüi n√∫t Home */
            margin-bottom: 20px;
            text-align: left; /* CƒÉn tr√°i */
        }

        /* C√°c ƒë√°p √°n */
        .options-container label {
            display: block;
            margin-bottom: 10px;
            font-size: 16px;
            text-align: left; /* CƒÉn tr√°i */
        }

        /* K·∫øt qu·∫£ khi ki·ªÉm tra ƒë√°p √°n */
        #result {
            margin-top: 20px;
            font-size: 16px;
            font-weight: bold;
            text-align: left; /* CƒÉn tr√°i */
        }

        /* C√°c n√∫t ƒëi·ªÅu h∆∞·ªõng */
        .controls {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            flex-wrap: wrap; /* ƒê·∫£m b·∫£o c√°c n√∫t s·∫Ω t·ª± ƒë·ªông xu·ªëng d√≤ng khi kh√¥ng ƒë·ªß kh√¥ng gian */
        }

        .controls button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            flex: 1;
            margin: 0 5px;
            min-width: 70px; /* ƒê·∫£m b·∫£o m·ªói n√∫t c√≥ chi·ªÅu r·ªông t·ªëi thi·ªÉu */
        }

        .controls button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        .controls button:hover {
            background-color: #45a049;
        }

        /* Media Query cho ƒëi·ªán tho·∫°i */
        @media (max-width: 768px) {
            /* Thay ƒë·ªïi k√≠ch th∆∞·ªõc font ch·ªØ v√† padding cho c√°c ph·∫ßn t·ª≠ */
            body {
                font-size: 14px;
            }

            .quiz-container {
                padding: 15px;
            }

            #question {
                font-size: 18px;
            }

            .options-container label {
                font-size: 14px;
            }

            .controls button {
                font-size: 14px;
                padding: 8px 16px;
            }

            /* Gi·ªØ c√°c n√∫t n·∫±m ngang v√† t·ª± ƒë·ªông x·∫øp h√†ng khi kh√¥ng ƒë·ªß kh√¥ng gian */
            .controls {
                flex-direction: row; /* B·∫£o ƒë·∫£m c√°c n√∫t lu√¥n n·∫±m ngang */
                justify-content: space-between;
                gap: 10px; /* Kho·∫£ng c√°ch gi·ªØa c√°c n√∫t */
            }
        }

        /* Media Query cho m√†n h√¨nh r·∫•t nh·ªè (v√≠ d·ª•, ƒëi·ªán tho·∫°i nh·ªè) */
        @media (max-width: 480px) {
            .controls button {
                padding: 8px 12px;
            }

            #question {
                font-size: 16px;
            }

            .options-container label {
                font-size: 13px;
            }
        }
        .timer {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: #ffeb3b;
            color: #000;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            z-index: 1000;
        }

    </style>
</head>
<body>
    <!-- N√∫t Home v√† Finish -->
    <div class="header">
        <button id="home" onclick="goHome()">Trang ch·ªß</button>
        <button id="finish" onclick="finishQuiz()" style="display: none;">Ch·∫•m ƒëi·ªÉm</button>
    </div>

    <!-- √î hi·ªÉn th·ªã th·ªùi gian c√≤n l·∫°i -->
    <div id="timer" class="timer"></div>

    <div class="quiz-container">
        <div id="question"></div>
        <form id="options" class="options-container"></form>
        <div class="controls">
            <button id="back" onclick="navigate(-1)" disabled>Back</button>
            <button id="check" onclick="checkAnswer()">Check</button>
            <button id="next" onclick="navigate(1)">Next</button>
        </div>
        <div id="result"></div>
    </div>

    <script>
        const successMessages = [
          "·ªú m√†y gi·ªèi qu√° üòè",
          "Th·∫±ng n√†y ch·∫Øc ƒÉn ·ªü hi·ªÅn ü§£",
          "Tao n√≥i r·ªìi m√†, ngu sao sai ƒë∆∞·ª£c ü§ü",
          "L·∫°i ƒë√∫ng n·ªØa k√¨a, ng·ª©a m·∫Øt vl üò§",
          "G√† m√† c≈©ng ƒë√∫ng h·∫£? üòú",
          "Th·ªÅ, ƒëo√°n b·ª´a c≈©ng tr√∫ng ü§Ø",
          "M√†y hack √†? üëÄ",
          "R√πa vl",
          "√îng ho√†ng ƒëo√°n m√≤ ƒë√¢y r·ªìi ü§°"
        ];
        const failMessages = [
            "M√π ch·ªØ h·∫£ con? ü§¶",
            "Sai be b√©t, nh·ª•c ch∆∞a üòù",
            "ƒê√∫ng l√† n√£o c√° v√†ng üêü",
            "Sai l√≤i ra m√† c√≤n b√†y ƒë·∫∑t üòè",
            "Tr·ªùi ƒë·∫•t ∆°i, sai m√† v·∫´n t·ª± tin üòÜ",
            "ƒêo√°n m√≤ c≈©ng kh√¥ng tr√∫ng n·ªïi ü§Ø",
            "Nh√¨n ƒë√°p √°n m√† th·∫•y th∆∞∆°ng ü•≤",
            "Ngu ch√≠nh th·ªëng r·ªìi b·∫°n ∆°i üòÇ"
        ];
        let questions = JSON.parse(localStorage.getItem('questions')) || [];
        let currentIndex = 0;

        // L·∫•y timeLimit t·ª´ localStorage, n·∫øu kh√¥ng c√≥ m·∫∑c ƒë·ªãnh l√† 10 ph√∫t
        let timeLimit = parseInt(localStorage.getItem('timeLimit')) || 10;
        let remainingTime = timeLimit * 60; // ƒê·ªïi sang gi√¢y

        document.addEventListener('DOMContentLoaded', () => {
            loadQuestion();
            startTimer();
        });

        // C·∫≠p nh·∫≠t th·ªùi gian ƒë·∫øm ng∆∞·ª£c
        function startTimer() {
            const timerElement = document.getElementById('timer');
            const timerInterval = setInterval(() => {
                const minutes = Math.floor(remainingTime / 60);
                const seconds = remainingTime % 60;

                // Hi·ªÉn th·ªã th·ªùi gian c√≤n l·∫°i
                timerElement.innerHTML = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
                remainingTime--;

                // Khi h·∫øt th·ªùi gian, t·ª± ƒë·ªông k·∫øt th√∫c b√†i thi
                if (remainingTime < 0) {
                    clearInterval(timerInterval);
                    finishQuiz();
                }
            }, 1000);
        }

        function loadQuestion() {
            const questionElement = document.getElementById('question');
            const optionsForm = document.getElementById('options');
            const resultElement = document.getElementById('result');
            const backButton = document.getElementById('back');
            const nextButton = document.getElementById('next');
            const finishButton = document.getElementById('finish');

            // X√≥a n·ªôi dung c≈©
            resultElement.innerHTML = '';
            optionsForm.innerHTML = '';

            // N·∫øu ƒë√£ v∆∞·ª£t qua c√¢u cu·ªëi, d·ª´ng hi·ªÉn th·ªã c√¢u h·ªèi
            if (currentIndex >= questions.length) {
                return;
            }

            // Hi·ªÉn th·ªã c√¢u h·ªèi hi·ªán t·∫°i
            const currentQuestion = questions[currentIndex];
            questionElement.innerHTML = `<h4>${currentQuestion.question}</h4>`;

            // T·∫°o radio button cho t·ª´ng ƒë√°p √°n
            currentQuestion.options.forEach((option, index) => {
                const optionHTML = `
                    <label>
                        <input type="checkbox" name="option" value="${index}" ${currentQuestion.selected?.includes(index) ? 'checked' : ''}>
                        <span>${option}</span>
                    </label><br>
                `;
                optionsForm.innerHTML += optionHTML;
            });

            // C·∫≠p nh·∫≠t tr·∫°ng th√°i n√∫t ƒëi·ªÅu h∆∞·ªõng
            backButton.disabled = currentIndex === 0;
            nextButton.disabled = currentIndex === questions.length - 1;
            finishButton.style.display = currentIndex === questions.length - 1 ? 'block' : 'none';
        }

        function checkAnswer() {
            const currentQuestion = questions[currentIndex];
            const resultElement = document.getElementById('result');
            const selectedOptions = [...document.querySelectorAll('input[name="option"]:checked')].map(el => parseInt(el.value));
    
            if (selectedOptions.length === 0) {
                resultElement.innerHTML = 'Ch·ªçn ƒë√°p √°n ƒëi ku!';
                return;
            }
    
            currentQuestion.selected = selectedOptions; // l∆∞u l·ª±a ch·ªçn
    
            // So s√°nh m·∫£ng selected v·ªõi answer
            const correctAnswers = currentQuestion.answer.sort((a,b)=>a-b);
            const chosenAnswers = selectedOptions.sort((a,b)=>a-b);
    
            if (JSON.stringify(correctAnswers) === JSON.stringify(chosenAnswers)) {
                const randomMsg = successMessages[Math.floor(Math.random() * successMessages.length)];
                resultElement.innerHTML = `<span style="color: green;">${randomMsg}</span>`;
            } else {
                const randomFail = failMessages[Math.floor(Math.random() * failMessages.length)];
                const res = correctAnswers.map(i => currentQuestion.options[i]).join(', ');
                resultElement.innerHTML = `
                    <span style="color: red;">
                        ${randomFail}<br>
                        ƒê√°p √°n ƒë√∫ng: ${res}
                    </span>
                `;
            }
        }

        function navigate(direction) {
            const selectedOptions = [...document.querySelectorAll('input[name="option"]:checked')].map(el => parseInt(el.value));
            if (selectedOptions.length > 0) {
                questions[currentIndex].selected = selectedOptions;
            }
    
            currentIndex += direction;
            if (currentIndex < 0) currentIndex = 0;
            if (currentIndex >= questions.length) currentIndex = questions.length - 1;
    
            loadQuestion();
        }

        function finishQuiz() {
            let score = 0;
            questions.forEach(question => {
                const correctAnswers = question.answer.sort((a,b)=>a-b);
                const chosenAnswers = (question.selected || []).sort((a,b)=>a-b);
                if (JSON.stringify(correctAnswers) === JSON.stringify(chosenAnswers)) {
                    score++;
                }
            });
    
            const questionElement = document.getElementById('question');
            const optionsForm = document.getElementById('options');
            const controls = document.querySelector('.controls');
    
            let d_score = score * 10.0 / questions.length;
            questionElement.innerHTML = `ƒê·∫°t ${d_score} ƒëi·ªÉm (${score}/${questions.length})`;
            optionsForm.innerHTML = '';
            controls.innerHTML = '';
        }

        function goHome() {
            window.location.href = 'https://hlthuc.github.io/vietmap/';  // Quay v·ªÅ trang ch·ªß
        }
    </script>
</body>
</html>
